<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>AMPS C/C++ Client Class Reference: AMPS::BlockStore Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AMPS C/C++ Client Class Reference
   </div>
   <div id="projectbrief">AMPS C/C++ Client Version 5.3.4.1</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classAMPS_1_1BlockStore.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classAMPS_1_1BlockStore-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">AMPS::BlockStore Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Used as a base class for other stores in the AMPS C++ client, this is an implementation that breaks a provided <a class="el" href="classAMPS_1_1Buffer.html" title="Abstract base class for implementing a buffer to be used by a StoreImpl for storage of publish messag...">Buffer</a> into uniform blocks for storing messages and tracks used and unused blocks.  
 <a href="classAMPS_1_1BlockStore.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="BlockStore_8hpp_source.html">BlockStore.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used as metadata for each block in a <a class="el" href="classAMPS_1_1Buffer.html" title="Abstract base class for implementing a buffer to be used by a StoreImpl for storage of publish messag...">Buffer</a>.  <a href="classAMPS_1_1BlockStore_1_1Block.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a56dac2897a799c1cebdaed3f895696bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a56dac2897a799c1cebdaed3f895696bf">BlockStore</a> (<a class="el" href="classAMPS_1_1Buffer.html">Buffer</a> *buffer_, amps_uint32_t blocksPerRealloc_=DEFAULT_BLOCKS_PER_REALLOC, amps_uint32_t blockHeaderSize_=DEFAULT_BLOCK_HEADER_SIZE, amps_uint32_t blockSize_=DEFAULT_BLOCK_SIZE)</td></tr>
<tr class="memdesc:a56dac2897a799c1cebdaed3f895696bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a <a class="el" href="classAMPS_1_1BlockStore.html" title="Used as a base class for other stores in the AMPS C++ client, this is an implementation that breaks a...">BlockStore</a> using buffer_ and default block size, that grows by blocksPerRealloc_ blocks when it must grow.  <a href="#a56dac2897a799c1cebdaed3f895696bf">More...</a><br /></td></tr>
<tr class="separator:a56dac2897a799c1cebdaed3f895696bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d5ecd657f3d6c3e775a076f81f14d7a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9d5ecd657f3d6c3e775a076f81f14d7a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a9d5ecd657f3d6c3e775a076f81f14d7a">~BlockStore</a> ()</td></tr>
<tr class="memdesc:a9d5ecd657f3d6c3e775a076f81f14d7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor that cleans up the buffer and other associated memory. <br /></td></tr>
<tr class="separator:a9d5ecd657f3d6c3e775a076f81f14d7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0acf787913b44e5382eda2ab95be4af3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0acf787913b44e5382eda2ab95be4af3"></a>
amps_uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a0acf787913b44e5382eda2ab95be4af3">getBlockSize</a> () const </td></tr>
<tr class="memdesc:a0acf787913b44e5382eda2ab95be4af3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the size of each <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a>, as set in the constructor. <br /></td></tr>
<tr class="separator:a0acf787913b44e5382eda2ab95be4af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e305450d58dd48acbfd0df13b22acf3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6e305450d58dd48acbfd0df13b22acf3"></a>
amps_uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a6e305450d58dd48acbfd0df13b22acf3">getBlockHeaderSize</a> () const </td></tr>
<tr class="memdesc:a6e305450d58dd48acbfd0df13b22acf3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the size of a header within each <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a>, as set in the constructor. <br /></td></tr>
<tr class="separator:a6e305450d58dd48acbfd0df13b22acf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a197b2f43988fa1e9fd0f64d28e5666cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a197b2f43988fa1e9fd0f64d28e5666cc">acquireRead</a> () const </td></tr>
<tr class="memdesc:a197b2f43988fa1e9fd0f64d28e5666cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acquire the lock for this object.  <a href="#a197b2f43988fa1e9fd0f64d28e5666cc">More...</a><br /></td></tr>
<tr class="separator:a197b2f43988fa1e9fd0f64d28e5666cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cdfcffc5f6dbbb0e95a47c9abdce87c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7cdfcffc5f6dbbb0e95a47c9abdce87c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a7cdfcffc5f6dbbb0e95a47c9abdce87c">releaseRead</a> () const </td></tr>
<tr class="memdesc:a7cdfcffc5f6dbbb0e95a47c9abdce87c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release the lock for this object. Used by RAII templates. <br /></td></tr>
<tr class="separator:a7cdfcffc5f6dbbb0e95a47c9abdce87c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dce7011fdbe8ac3e83c81a15c5e5a7d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1dce7011fdbe8ac3e83c81a15c5e5a7d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a1dce7011fdbe8ac3e83c81a15c5e5a7d">signalAll</a> ()</td></tr>
<tr class="memdesc:a1dce7011fdbe8ac3e83c81a15c5e5a7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signal lock waiters. <br /></td></tr>
<tr class="separator:a1dce7011fdbe8ac3e83c81a15c5e5a7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3e3dfabf88b098c7ba06896cf1bcdd2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af3e3dfabf88b098c7ba06896cf1bcdd2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#af3e3dfabf88b098c7ba06896cf1bcdd2">wait</a> ()</td></tr>
<tr class="memdesc:af3e3dfabf88b098c7ba06896cf1bcdd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait for a signal. <br /></td></tr>
<tr class="separator:af3e3dfabf88b098c7ba06896cf1bcdd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa462382ca943e7138d7bda173ca3ba74"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#aa462382ca943e7138d7bda173ca3ba74">wait</a> (long timeout_)</td></tr>
<tr class="memdesc:aa462382ca943e7138d7bda173ca3ba74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait timeout_ ms for a signal.  <a href="#aa462382ca943e7138d7bda173ca3ba74">More...</a><br /></td></tr>
<tr class="separator:aa462382ca943e7138d7bda173ca3ba74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac811adb039f577d3093fad3c9cfa34fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#ac811adb039f577d3093fad3c9cfa34fc">setResizeHandler</a> (ResizeHandler resizeHandler_, void *userData_)</td></tr>
<tr class="memdesc:ac811adb039f577d3093fad3c9cfa34fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a resize handler that is called with the new total size of the <a class="el" href="classAMPS_1_1Buffer.html" title="Abstract base class for implementing a buffer to be used by a StoreImpl for storage of publish messag...">Buffer</a>.  <a href="#ac811adb039f577d3093fad3c9cfa34fc">More...</a><br /></td></tr>
<tr class="separator:ac811adb039f577d3093fad3c9cfa34fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f612c2225104d853093cbb572aaf2a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a9f612c2225104d853093cbb572aaf2a5">front</a> () const </td></tr>
<tr class="memdesc:a9f612c2225104d853093cbb572aaf2a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the first used block in the store.  <a href="#a9f612c2225104d853093cbb572aaf2a5">More...</a><br /></td></tr>
<tr class="separator:a9f612c2225104d853093cbb572aaf2a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eb553bfb71d756aded672aa9b5a9e6e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a6eb553bfb71d756aded672aa9b5a9e6e">back</a> () const </td></tr>
<tr class="memdesc:a6eb553bfb71d756aded672aa9b5a9e6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the last used block in the store.  <a href="#a6eb553bfb71d756aded672aa9b5a9e6e">More...</a><br /></td></tr>
<tr class="separator:a6eb553bfb71d756aded672aa9b5a9e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafe19b5a843a7b1caef232b68310df8a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#aafe19b5a843a7b1caef232b68310df8a">setFreeList</a> (<a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *block_, amps_uint32_t freeCount_)</td></tr>
<tr class="memdesc:aafe19b5a843a7b1caef232b68310df8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow containing classes to initialize the free list in recovery.  <a href="#aafe19b5a843a7b1caef232b68310df8a">More...</a><br /></td></tr>
<tr class="separator:aafe19b5a843a7b1caef232b68310df8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c5b769365dbfea18b1b700501a74885"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a7c5b769365dbfea18b1b700501a74885">setUsedList</a> (<a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *block_)</td></tr>
<tr class="memdesc:a7c5b769365dbfea18b1b700501a74885"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow containing classes to initialize the used list in recovery.  <a href="#a7c5b769365dbfea18b1b700501a74885">More...</a><br /></td></tr>
<tr class="separator:a7c5b769365dbfea18b1b700501a74885"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5912b1b6a99002bf27022484f6049f73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a5912b1b6a99002bf27022484f6049f73">setEndOfUsedList</a> (<a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *block_)</td></tr>
<tr class="memdesc:a5912b1b6a99002bf27022484f6049f73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow containing classes to initialize the used list in recovery.  <a href="#a5912b1b6a99002bf27022484f6049f73">More...</a><br /></td></tr>
<tr class="separator:a5912b1b6a99002bf27022484f6049f73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e075bac138a57c0e1758d99c6ee4dc9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a4e075bac138a57c0e1758d99c6ee4dc9">addBlocks</a> (<a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *blockArray_)</td></tr>
<tr class="memdesc:a4e075bac138a57c0e1758d99c6ee4dc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow users to create <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> arrays during recovery that are tracked for cleanup here with all other <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> arrays.  <a href="#a4e075bac138a57c0e1758d99c6ee4dc9">More...</a><br /></td></tr>
<tr class="separator:a4e075bac138a57c0e1758d99c6ee4dc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa328279eb286cfadf72629ab59e2a2b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#aaa328279eb286cfadf72629ab59e2a2b">get</a> (amps_uint32_t numBlocksInChain_)</td></tr>
<tr class="memdesc:aaa328279eb286cfadf72629ab59e2a2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the requested number of Blocks as a chain from the free list.  <a href="#aaa328279eb286cfadf72629ab59e2a2b">More...</a><br /></td></tr>
<tr class="separator:aaa328279eb286cfadf72629ab59e2a2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af86baeaadc2625793bba2390f261c09d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#af86baeaadc2625793bba2390f261c09d">put</a> (<a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *block_)</td></tr>
<tr class="memdesc:af86baeaadc2625793bba2390f261c09d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the given chain of Blocks to the free list for reuse.  <a href="#af86baeaadc2625793bba2390f261c09d">More...</a><br /></td></tr>
<tr class="separator:af86baeaadc2625793bba2390f261c09d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfa2b6cfb49351cf3846d106df509a5f"><td class="memItemLeft" align="right" valign="top">AMPS_ATOMIC_BASE_TYPE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#acfa2b6cfb49351cf3846d106df509a5f">put</a> (amps_uint64_t sequence_)</td></tr>
<tr class="memdesc:acfa2b6cfb49351cf3846d106df509a5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return all Blocks with sequence &lt;= sequence_ for reuse.  <a href="#acfa2b6cfb49351cf3846d106df509a5f">More...</a><br /></td></tr>
<tr class="separator:acfa2b6cfb49351cf3846d106df509a5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a287902c6ad9517fbc119544cf21ea6e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a287902c6ad9517fbc119544cf21ea6e3">putAll</a> (<a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *block_)</td></tr>
<tr class="memdesc:a287902c6ad9517fbc119544cf21ea6e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return all Blocks starting with the given <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> to the free list.  <a href="#a287902c6ad9517fbc119544cf21ea6e3">More...</a><br /></td></tr>
<tr class="separator:a287902c6ad9517fbc119544cf21ea6e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9989a7071bd99c8c6453dcb6345b817"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#ae9989a7071bd99c8c6453dcb6345b817">init</a> ()</td></tr>
<tr class="memdesc:ae9989a7071bd99c8c6453dcb6345b817"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize, assuming that _buffer has no existing information.  <a href="#ae9989a7071bd99c8c6453dcb6345b817">More...</a><br /></td></tr>
<tr class="separator:ae9989a7071bd99c8c6453dcb6345b817"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa228b4b37a66daedaf12df786c55acdc"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#aa228b4b37a66daedaf12df786c55acdc">getDefaultResizeSize</a> () const </td></tr>
<tr class="memdesc:aa228b4b37a66daedaf12df786c55acdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the default number of bytes for each resize.  <a href="#aa228b4b37a66daedaf12df786c55acdc">More...</a><br /></td></tr>
<tr class="separator:aa228b4b37a66daedaf12df786c55acdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e80e15646d9259a338488e0c1e2337"><td class="memItemLeft" align="right" valign="top">amps_uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a59e80e15646d9259a338488e0c1e2337">getDefaultResizeBlocks</a> () const </td></tr>
<tr class="memdesc:a59e80e15646d9259a338488e0c1e2337"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the default number of blocks for each resize.  <a href="#a59e80e15646d9259a338488e0c1e2337">More...</a><br /></td></tr>
<tr class="separator:a59e80e15646d9259a338488e0c1e2337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a913b16e404ff92ad810165d5edb381e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#a913b16e404ff92ad810165d5edb381e4">resizeBuffer</a> (size_t size_, amps_uint32_t *pNewBlocks_)</td></tr>
<tr class="memdesc:a913b16e404ff92ad810165d5edb381e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resize the buffer to the requested size, returning all new space.  <a href="#a913b16e404ff92ad810165d5edb381e4">More...</a><br /></td></tr>
<tr class="separator:a913b16e404ff92ad810165d5edb381e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6594f5436d39d10fb64e6572a7f614c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#ac6594f5436d39d10fb64e6572a7f614c">resize</a> (size_t size_)</td></tr>
<tr class="memdesc:ac6594f5436d39d10fb64e6572a7f614c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resize the buffer to the requested size, adding all new space as unused Blocks for the free list.  <a href="#ac6594f5436d39d10fb64e6572a7f614c">More...</a><br /></td></tr>
<tr class="separator:ac6594f5436d39d10fb64e6572a7f614c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adda831260c980fd85ced9756baaa53ba"><td class="memItemLeft" align="right" valign="top">amps_uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#adda831260c980fd85ced9756baaa53ba">setBlockSize</a> (amps_uint32_t blockSize_)</td></tr>
<tr class="memdesc:adda831260c980fd85ced9756baaa53ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the size to use for all Blocks.  <a href="#adda831260c980fd85ced9756baaa53ba">More...</a><br /></td></tr>
<tr class="separator:adda831260c980fd85ced9756baaa53ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acad686f97295410eef2fd75637da0e55"><td class="memItemLeft" align="right" valign="top">amps_uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#acad686f97295410eef2fd75637da0e55">setBlockHeaderSize</a> (amps_uint32_t blockHeaderSize_)</td></tr>
<tr class="memdesc:acad686f97295410eef2fd75637da0e55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the size to use for the header for all Blocks.  <a href="#acad686f97295410eef2fd75637da0e55">More...</a><br /></td></tr>
<tr class="separator:acad686f97295410eef2fd75637da0e55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4b7d229e8b511dc07d8863f1a0d7e21"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAMPS_1_1Buffer.html">Buffer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1BlockStore.html#ac4b7d229e8b511dc07d8863f1a0d7e21">getBuffer</a> ()</td></tr>
<tr class="memdesc:ac4b7d229e8b511dc07d8863f1a0d7e21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the buffer underlying the store for direct write/read.  <a href="#ac4b7d229e8b511dc07d8863f1a0d7e21">More...</a><br /></td></tr>
<tr class="separator:ac4b7d229e8b511dc07d8863f1a0d7e21"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Used as a base class for other stores in the AMPS C++ client, this is an implementation that breaks a provided <a class="el" href="classAMPS_1_1Buffer.html" title="Abstract base class for implementing a buffer to be used by a StoreImpl for storage of publish messag...">Buffer</a> into uniform blocks for storing messages and tracks used and unused blocks. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a56dac2897a799c1cebdaed3f895696bf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMPS::BlockStore::BlockStore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAMPS_1_1Buffer.html">Buffer</a> *&#160;</td>
          <td class="paramname"><em>buffer_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amps_uint32_t&#160;</td>
          <td class="paramname"><em>blocksPerRealloc_</em> = <code>DEFAULT_BLOCKS_PER_REALLOC</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amps_uint32_t&#160;</td>
          <td class="paramname"><em>blockHeaderSize_</em> = <code>DEFAULT_BLOCK_HEADER_SIZE</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amps_uint32_t&#160;</td>
          <td class="paramname"><em>blockSize_</em> = <code>DEFAULT_BLOCK_SIZE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a <a class="el" href="classAMPS_1_1BlockStore.html" title="Used as a base class for other stores in the AMPS C++ client, this is an implementation that breaks a...">BlockStore</a> using buffer_ and default block size, that grows by blocksPerRealloc_ blocks when it must grow. </p>
<p>The initialization or recovery from the buffer_ is handled outside of this class by either calling <a class="el" href="classAMPS_1_1BlockStore.html#ae9989a7071bd99c8c6453dcb6345b817" title="Initialize, assuming that _buffer has no existing information. ">init()</a> to start new, or by recovering the Blocks and using <a class="el" href="classAMPS_1_1BlockStore.html#aafe19b5a843a7b1caef232b68310df8a" title="Allow containing classes to initialize the free list in recovery. ">setFreeList()</a>, <a class="el" href="classAMPS_1_1BlockStore.html#a7c5b769365dbfea18b1b700501a74885" title="Allow containing classes to initialize the used list in recovery. ">setUsedList()</a>, <a class="el" href="classAMPS_1_1BlockStore.html#a5912b1b6a99002bf27022484f6049f73" title="Allow containing classes to initialize the used list in recovery. ">setEndOfUsedList()</a> and <a class="el" href="classAMPS_1_1BlockStore.html#a4e075bac138a57c0e1758d99c6ee4dc9" title="Allow users to create Block arrays during recovery that are tracked for cleanup here with all other B...">addBlocks()</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer_</td><td>Pointer to an allocated <a class="el" href="classAMPS_1_1Buffer.html" title="Abstract base class for implementing a buffer to be used by a StoreImpl for storage of publish messag...">Buffer</a> implementation that will be used for storage. The store will delete buffer_ when it is destructed. </td></tr>
    <tr><td class="paramname">blocksPerRealloc_</td><td>Number of blocks to add to when growing the size of the <a class="el" href="classAMPS_1_1Buffer.html" title="Abstract base class for implementing a buffer to be used by a StoreImpl for storage of publish messag...">Buffer</a>. </td></tr>
    <tr><td class="paramname">blockSize_</td><td>The size to use for each block in the store. </td></tr>
    <tr><td class="paramname">blockHeaderSize_</td><td>The size of the header section of each block, which is also the only memory that needs to be cleared in a block for it to skipped during recovery and be reusable. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a197b2f43988fa1e9fd0f64d28e5666cc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AMPS::BlockStore::acquireRead </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Acquire the lock for this object. </p>
<p>Used by RAII templates. The lock should be acquired before calling any other functions below and held while using the Buffer* returned by <a class="el" href="classAMPS_1_1BlockStore.html#ac4b7d229e8b511dc07d8863f1a0d7e21" title="Return the buffer underlying the store for direct write/read. ">getBuffer()</a>. </p>

</div>
</div>
<a class="anchor" id="a4e075bac138a57c0e1758d99c6ee4dc9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AMPS::BlockStore::addBlocks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *&#160;</td>
          <td class="paramname"><em>blockArray_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allow users to create <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> arrays during recovery that are tracked for cleanup here with all other <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> arrays. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blockArray_</td><td>A pointer the beginning of the allocated array. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6eb553bfb71d756aded672aa9b5a9e6e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a>* AMPS::BlockStore::back </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the last used block in the store. </p>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the last used block, which may be null if the store is empty, or the same as <a class="el" href="classAMPS_1_1BlockStore.html#a9f612c2225104d853093cbb572aaf2a5" title="Get the first used block in the store. ">front()</a> if there is only one block in use in the store. </dd></dl>

</div>
</div>
<a class="anchor" id="a9f612c2225104d853093cbb572aaf2a5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a>* AMPS::BlockStore::front </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the first used block in the store. </p>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the first used block, which may be null if the store is currently empty. </dd></dl>

</div>
</div>
<a class="anchor" id="aaa328279eb286cfadf72629ab59e2a2b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a>* AMPS::BlockStore::get </td>
          <td>(</td>
          <td class="paramtype">amps_uint32_t&#160;</td>
          <td class="paramname"><em>numBlocksInChain_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the requested number of Blocks as a chain from the free list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">numBlocksInChain_</td><td>The number of blocks needed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the first <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> in the chain. Remaining Blocks are found at nextInChain. </dd></dl>

</div>
</div>
<a class="anchor" id="ac4b7d229e8b511dc07d8863f1a0d7e21"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAMPS_1_1Buffer.html">Buffer</a>* AMPS::BlockStore::getBuffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the buffer underlying the store for direct write/read. </p>
<dl class="section return"><dt>Returns</dt><dd>The wrapped buffer. </dd></dl>

</div>
</div>
<a class="anchor" id="a59e80e15646d9259a338488e0c1e2337"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amps_uint32_t AMPS::BlockStore::getDefaultResizeBlocks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the default number of blocks for each resize. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of blocks by which the store resizes itself. </dd></dl>

</div>
</div>
<a class="anchor" id="aa228b4b37a66daedaf12df786c55acdc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t AMPS::BlockStore::getDefaultResizeSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the default number of bytes for each resize. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes by which the store resizes itself. </dd></dl>

</div>
</div>
<a class="anchor" id="ae9989a7071bd99c8c6453dcb6345b817"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AMPS::BlockStore::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize, assuming that _buffer has no existing information. </p>
<p>Divide the _buffer in Blocks and put them all into the free list. </p>

</div>
</div>
<a class="anchor" id="af86baeaadc2625793bba2390f261c09d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AMPS::BlockStore::put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *&#160;</td>
          <td class="paramname"><em>block_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the given chain of Blocks to the free list for reuse. </p>
<p>Used when returning a <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> out of order. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block_</td><td>The first <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> in the chain. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acfa2b6cfb49351cf3846d106df509a5f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMPS_ATOMIC_BASE_TYPE AMPS::BlockStore::put </td>
          <td>(</td>
          <td class="paramtype">amps_uint64_t&#160;</td>
          <td class="paramname"><em>sequence_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return all Blocks with sequence &lt;= sequence_ for reuse. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sequence_</td><td>The highest sequence number to free. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of items removed. </dd></dl>

</div>
</div>
<a class="anchor" id="a287902c6ad9517fbc119544cf21ea6e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AMPS::BlockStore::putAll </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *&#160;</td>
          <td class="paramname"><em>block_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return all Blocks starting with the given <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> to the free list. </p>
<p>Used if corruption was detected or to remove the end of what's stored. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block_</td><td>The beginning of list of Blocks to return. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac6594f5436d39d10fb64e6572a7f614c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AMPS::BlockStore::resize </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resize the buffer to the requested size, adding all new space as unused Blocks for the free list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size_</td><td>The new size for the _buffer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a913b16e404ff92ad810165d5edb381e4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a>* AMPS::BlockStore::resizeBuffer </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amps_uint32_t *&#160;</td>
          <td class="paramname"><em>pNewBlocks_</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resize the buffer to the requested size, returning all new space. </p>
<p>This is used during recovery when additional space is needed that isn't added immediately to the internal accounting. It's also used by the normal resize function, which takes care of the accounting. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size_</td><td>The new size for the _buffer. </td></tr>
    <tr><td class="paramname">pNewBlocks_</td><td>A pointer where the number of new blocks created will be stored for the calling function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acad686f97295410eef2fd75637da0e55"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amps_uint32_t AMPS::BlockStore::setBlockHeaderSize </td>
          <td>(</td>
          <td class="paramtype">amps_uint32_t&#160;</td>
          <td class="paramname"><em>blockHeaderSize_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the size to use for the header for all Blocks. </p>
<p>This should only be called before any Blocks have been created. Returns the old <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> header size. </p>

</div>
</div>
<a class="anchor" id="adda831260c980fd85ced9756baaa53ba"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amps_uint32_t AMPS::BlockStore::setBlockSize </td>
          <td>(</td>
          <td class="paramtype">amps_uint32_t&#160;</td>
          <td class="paramname"><em>blockSize_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the size to use for all Blocks. </p>
<p>This should only be called before any Blocks have been created. Returns old <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> size. </p>

</div>
</div>
<a class="anchor" id="a5912b1b6a99002bf27022484f6049f73"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AMPS::BlockStore::setEndOfUsedList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *&#160;</td>
          <td class="paramname"><em>block_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allow containing classes to initialize the used list in recovery. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block_</td><td>A pointer to the last <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> of the used list. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aafe19b5a843a7b1caef232b68310df8a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AMPS::BlockStore::setFreeList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *&#160;</td>
          <td class="paramname"><em>block_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amps_uint32_t&#160;</td>
          <td class="paramname"><em>freeCount_</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allow containing classes to initialize the free list in recovery. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block_</td><td>A pointer the first <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> of the free list. </td></tr>
    <tr><td class="paramname">freeCount_</td><td>The number of free blocks in the chain. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac811adb039f577d3093fad3c9cfa34fc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AMPS::BlockStore::setResizeHandler </td>
          <td>(</td>
          <td class="paramtype">ResizeHandler&#160;</td>
          <td class="paramname"><em>resizeHandler_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>userData_</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set a resize handler that is called with the new total size of the <a class="el" href="classAMPS_1_1Buffer.html" title="Abstract base class for implementing a buffer to be used by a StoreImpl for storage of publish messag...">Buffer</a>. </p>
<p>The resize handler can return true to allow the resize or false to prevent it. If it returns false, some action should have been taken to create room or it will be called repeatedly in a loop. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resizeHandler_</td><td>A ResizeHandler function to be invoked for every resize attempt. </td></tr>
    <tr><td class="paramname">userData_</td><td>A pointer to any data that should be passed to the ResizeHandler when invoked. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7c5b769365dbfea18b1b700501a74885"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AMPS::BlockStore::setUsedList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAMPS_1_1BlockStore_1_1Block.html">Block</a> *&#160;</td>
          <td class="paramname"><em>block_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allow containing classes to initialize the used list in recovery. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block_</td><td>A pointer the first <a class="el" href="classAMPS_1_1BlockStore_1_1Block.html" title="Used as metadata for each block in a Buffer. ">Block</a> of the used list. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa462382ca943e7138d7bda173ca3ba74"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool AMPS::BlockStore::wait </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>timeout_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wait timeout_ ms for a signal. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timeout_</td><td>The maximum time to wait in milliseconds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true for signal received, false for timeout. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/amps/<a class="el" href="BlockStore_8hpp_source.html">BlockStore.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>AMPS</b></li><li class="navelem"><a class="el" href="classAMPS_1_1BlockStore.html">BlockStore</a></li>
    <li class="footer">Generated on Mon Oct 9 2023 18:11:31 for AMPS C/C++ Client Class Reference by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
