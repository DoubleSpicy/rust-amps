<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>AMPS C/C++ Client Class Reference: AMPS::StoreImpl Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AMPS C/C++ Client Class Reference
   </div>
   <div id="projectbrief">AMPS C/C++ Client Version 5.3.4.1</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classAMPS_1_1StoreImpl.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classAMPS_1_1StoreImpl-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">AMPS::StoreImpl Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Abstract base class for storing published messages for an HA publisher client.  
 <a href="classAMPS_1_1StoreImpl.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ampsplusplus_8hpp_source.html">ampsplusplus.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for AMPS::StoreImpl:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="classAMPS_1_1StoreImpl.png" usemap="#AMPS::StoreImpl_map" alt=""/>
  <map id="AMPS::StoreImpl_map" name="AMPS::StoreImpl_map">
<area href="classAMPS_1_1BlockPublishStore.html" title="Used as a base class for other stores in the AMPS C++ client, this is an implementation of StoreImpl ..." alt="AMPS::BlockPublishStore" shape="rect" coords="90,56,261,80"/>
<area href="classAMPS_1_1HybridPublishStore.html" title="An implementation of StoreImpl for publication. " alt="AMPS::HybridPublishStore" shape="rect" coords="271,56,442,80"/>
<area href="classAMPS_1_1MemoryPublishStore.html" title="A StoreImpl implementation that uses MemoryStoreBuffer as its buffer to hold published messages in me..." alt="AMPS::MemoryPublishStore" shape="rect" coords="0,112,171,136"/>
<area href="classAMPS_1_1PublishStore.html" title="A StoreImpl implementation that uses a memory-mapped file to provide a publish store that persists ac..." alt="AMPS::PublishStore" shape="rect" coords="181,112,352,136"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae6dffba99210c30facc396491f271e77"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1StoreImpl.html#ae6dffba99210c30facc396491f271e77">StoreImpl</a> (bool errorOnPublishGap_=false)</td></tr>
<tr class="memdesc:ae6dffba99210c30facc396491f271e77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <a href="#ae6dffba99210c30facc396491f271e77">More...</a><br /></td></tr>
<tr class="separator:ae6dffba99210c30facc396491f271e77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76e41f2c8c132c63ed560135949cd220"><td class="memItemLeft" align="right" valign="top">virtual amps_uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1StoreImpl.html#a76e41f2c8c132c63ed560135949cd220">store</a> (const <a class="el" href="classAMPS_1_1Message.html">Message</a> &amp;message_)=0</td></tr>
<tr class="memdesc:a76e41f2c8c132c63ed560135949cd220"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called by <a class="el" href="classAMPS_1_1Client.html" title="Client represents a connection to an AMPS server, but does not provide failover or reconnection behav...">Client</a> to store a message being published.  <a href="#a76e41f2c8c132c63ed560135949cd220">More...</a><br /></td></tr>
<tr class="separator:a76e41f2c8c132c63ed560135949cd220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a391f99cd236d3a2370638596e96063"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1StoreImpl.html#a3a391f99cd236d3a2370638596e96063">discardUpTo</a> (amps_uint64_t index_)=0</td></tr>
<tr class="memdesc:a3a391f99cd236d3a2370638596e96063"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called by <a class="el" href="classAMPS_1_1Client.html" title="Client represents a connection to an AMPS server, but does not provide failover or reconnection behav...">Client</a> to indicate that all messages up to and including.  <a href="#a3a391f99cd236d3a2370638596e96063">More...</a><br /></td></tr>
<tr class="separator:a3a391f99cd236d3a2370638596e96063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3326d25b8aa2df5a93db3629b60cc21"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1StoreImpl.html#ac3326d25b8aa2df5a93db3629b60cc21">replay</a> (<a class="el" href="classAMPS_1_1StoreReplayer.html">StoreReplayer</a> &amp;replayer_)=0</td></tr>
<tr class="memdesc:ac3326d25b8aa2df5a93db3629b60cc21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called by <a class="el" href="classAMPS_1_1Client.html" title="Client represents a connection to an AMPS server, but does not provide failover or reconnection behav...">Client</a> to get all stored and non-discarded messages replayed by the store onto the <a class="el" href="classAMPS_1_1StoreReplayer.html" title="Abstract base class for replaying a publish message. ">StoreReplayer</a>.  <a href="#ac3326d25b8aa2df5a93db3629b60cc21">More...</a><br /></td></tr>
<tr class="separator:ac3326d25b8aa2df5a93db3629b60cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada24473da48fd544d789b7ec2dac7d08"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1StoreImpl.html#ada24473da48fd544d789b7ec2dac7d08">replaySingle</a> (<a class="el" href="classAMPS_1_1StoreReplayer.html">StoreReplayer</a> &amp;replayer_, amps_uint64_t index_)=0</td></tr>
<tr class="memdesc:ada24473da48fd544d789b7ec2dac7d08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called by <a class="el" href="classAMPS_1_1Client.html" title="Client represents a connection to an AMPS server, but does not provide failover or reconnection behav...">Client</a> to get a single message replayed by the store onto the <a class="el" href="classAMPS_1_1StoreReplayer.html" title="Abstract base class for replaying a publish message. ">StoreReplayer</a>.  <a href="#ada24473da48fd544d789b7ec2dac7d08">More...</a><br /></td></tr>
<tr class="separator:ada24473da48fd544d789b7ec2dac7d08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ba03a337bf6cc5ce6545fca968ff226"><td class="memItemLeft" align="right" valign="top">virtual size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1StoreImpl.html#a6ba03a337bf6cc5ce6545fca968ff226">unpersistedCount</a> () const  =0</td></tr>
<tr class="memdesc:a6ba03a337bf6cc5ce6545fca968ff226"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to return how many messages are in the store that have not been discarded, indicating that they are not yet persisted by the AMPS server.  <a href="#a6ba03a337bf6cc5ce6545fca968ff226">More...</a><br /></td></tr>
<tr class="separator:a6ba03a337bf6cc5ce6545fca968ff226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4405a4c73ea6dc3df17b5663d191cc8e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1StoreImpl.html#a4405a4c73ea6dc3df17b5663d191cc8e">flush</a> (long timeout_)=0</td></tr>
<tr class="memdesc:a4405a4c73ea6dc3df17b5663d191cc8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to wait for the <a class="el" href="classAMPS_1_1Store.html" title="Handle class for StoreImpl classes that track publish messages. ">Store</a> to discard everything that has been stored up to the point in time when flush is called.  <a href="#a4405a4c73ea6dc3df17b5663d191cc8e">More...</a><br /></td></tr>
<tr class="separator:a4405a4c73ea6dc3df17b5663d191cc8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5060827d0e062282e1dbf25cbc2a2e3"><td class="memItemLeft" align="right" valign="top">virtual amps_uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1StoreImpl.html#af5060827d0e062282e1dbf25cbc2a2e3">getLowestUnpersisted</a> () const  =0</td></tr>
<tr class="memdesc:af5060827d0e062282e1dbf25cbc2a2e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the oldest unpersisted message sequence in the store.  <a href="#af5060827d0e062282e1dbf25cbc2a2e3">More...</a><br /></td></tr>
<tr class="separator:af5060827d0e062282e1dbf25cbc2a2e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24fd9abeba9620f7d515b0933fc0afb8"><td class="memItemLeft" align="right" valign="top">virtual amps_uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1StoreImpl.html#a24fd9abeba9620f7d515b0933fc0afb8">getLastPersisted</a> ()=0</td></tr>
<tr class="memdesc:a24fd9abeba9620f7d515b0933fc0afb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the last persisted sequence number.  <a href="#a24fd9abeba9620f7d515b0933fc0afb8">More...</a><br /></td></tr>
<tr class="separator:a24fd9abeba9620f7d515b0933fc0afb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af38461a40772ee3147546e0e6132eea4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1StoreImpl.html#af38461a40772ee3147546e0e6132eea4">setResizeHandler</a> (PublishStoreResizeHandler handler_, void *userData_)</td></tr>
<tr class="memdesc:af38461a40772ee3147546e0e6132eea4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a handler to be called if the <a class="el" href="classAMPS_1_1Store.html" title="Handle class for StoreImpl classes that track publish messages. ">Store</a> needs to resize in order to keep storing messages.  <a href="#af38461a40772ee3147546e0e6132eea4">More...</a><br /></td></tr>
<tr class="separator:af38461a40772ee3147546e0e6132eea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a2b96fcfc9e76a87c1854edc7c3f7d7ce"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2b96fcfc9e76a87c1854edc7c3f7d7ce"></a>
static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1StoreImpl.html#a2b96fcfc9e76a87c1854edc7c3f7d7ce">getUnsetPosition</a> ()</td></tr>
<tr class="memdesc:a2b96fcfc9e76a87c1854edc7c3f7d7ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to return the value used to represent not found or unset. <br /></td></tr>
<tr class="separator:a2b96fcfc9e76a87c1854edc7c3f7d7ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e0d9dc3d5fbb2c45a1c990c9606cab"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a23e0d9dc3d5fbb2c45a1c990c9606cab"></a>
static amps_uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAMPS_1_1StoreImpl.html#a23e0d9dc3d5fbb2c45a1c990c9606cab">getUnsetSequence</a> ()</td></tr>
<tr class="memdesc:a23e0d9dc3d5fbb2c45a1c990c9606cab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to return the value used to represent no such sequence. <br /></td></tr>
<tr class="separator:a23e0d9dc3d5fbb2c45a1c990c9606cab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Abstract base class for storing published messages for an HA publisher client. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ae6dffba99210c30facc396491f271e77"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMPS::StoreImpl::StoreImpl </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>errorOnPublishGap_</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorOnPublishGap_</td><td>If true, PublishStoreGapException can be thrown by the store if the client logs onto a server that appears to be missing messages no longer held in the store. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a3a391f99cd236d3a2370638596e96063"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void AMPS::StoreImpl::discardUpTo </td>
          <td>(</td>
          <td class="paramtype">amps_uint64_t&#160;</td>
          <td class="paramname"><em>index_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called by <a class="el" href="classAMPS_1_1Client.html" title="Client represents a connection to an AMPS server, but does not provide failover or reconnection behav...">Client</a> to indicate that all messages up to and including. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index_</td><td>have been successfully published to the server and are no longer required to be in the store. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">PublishStoreGapException</td><td>If index_ &lt; <a class="el" href="classAMPS_1_1StoreImpl.html#a24fd9abeba9620f7d515b0933fc0afb8" title="Get the last persisted sequence number. ">getLastPersisted()</a> which could leave a gap on the server of missing messages from this <a class="el" href="classAMPS_1_1Client.html" title="Client represents a connection to an AMPS server, but does not provide failover or reconnection behav...">Client</a>. </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classAMPS_1_1BlockPublishStore.html#a2a9eceb814716f96595f10022ffa6765">AMPS::BlockPublishStore</a>, and <a class="el" href="classAMPS_1_1HybridPublishStore.html#ad39723f76c84215bfc78d1226c0bec0f">AMPS::HybridPublishStore</a>.</p>

</div>
</div>
<a class="anchor" id="a4405a4c73ea6dc3df17b5663d191cc8e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void AMPS::StoreImpl::flush </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>timeout_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to wait for the <a class="el" href="classAMPS_1_1Store.html" title="Handle class for StoreImpl classes that track publish messages. ">Store</a> to discard everything that has been stored up to the point in time when flush is called. </p>
<p>It will get the current max and wait up to timeout for that message to be discarded </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timeout_</td><td>The number of milliseconds to wait for the messages to be acknowledged by AMPS and discarded by the <a class="el" href="classAMPS_1_1Store.html" title="Handle class for StoreImpl classes that track publish messages. ">Store</a>. 0 indicates no timeout. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DisconnectedException</td><td>The <a class="el" href="classAMPS_1_1Client.html" title="Client represents a connection to an AMPS server, but does not provide failover or reconnection behav...">Client</a> is no longer connected to a server. </td></tr>
    <tr><td class="paramname">ConnectionException</td><td>An error occurred while sending the message. </td></tr>
    <tr><td class="paramname">TimedOutException</td><td>The publish command was not acked in the allowed time. </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classAMPS_1_1BlockPublishStore.html#a869487d81babc15d3806c57045b154c7">AMPS::BlockPublishStore</a>, and <a class="el" href="classAMPS_1_1HybridPublishStore.html#a0a79aaa1013f282d621a9e27760c57a5">AMPS::HybridPublishStore</a>.</p>

</div>
</div>
<a class="anchor" id="a24fd9abeba9620f7d515b0933fc0afb8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual amps_uint64_t AMPS::StoreImpl::getLastPersisted </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the last persisted sequence number. </p>
<dl class="section return"><dt>Returns</dt><dd>The sequence of the last persisted message. </dd></dl>

<p>Implemented in <a class="el" href="classAMPS_1_1BlockPublishStore.html#abeebc89280aaee041c9279aca9048af5">AMPS::BlockPublishStore</a>, and <a class="el" href="classAMPS_1_1HybridPublishStore.html#a87bce3f512e698abbf5e4361ffbb8dff">AMPS::HybridPublishStore</a>.</p>

</div>
</div>
<a class="anchor" id="af5060827d0e062282e1dbf25cbc2a2e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual amps_uint64_t AMPS::StoreImpl::getLowestUnpersisted </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the oldest unpersisted message sequence in the store. </p>
<dl class="section return"><dt>Returns</dt><dd>The sequence of the oldest message. </dd></dl>

<p>Implemented in <a class="el" href="classAMPS_1_1BlockPublishStore.html#ad823f17c78979c5e948ba6c64e8ed494">AMPS::BlockPublishStore</a>, and <a class="el" href="classAMPS_1_1HybridPublishStore.html#a1a11e316618697d930edd479ba3a28fb">AMPS::HybridPublishStore</a>.</p>

</div>
</div>
<a class="anchor" id="ac3326d25b8aa2df5a93db3629b60cc21"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void AMPS::StoreImpl::replay </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAMPS_1_1StoreReplayer.html">StoreReplayer</a> &amp;&#160;</td>
          <td class="paramname"><em>replayer_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called by <a class="el" href="classAMPS_1_1Client.html" title="Client represents a connection to an AMPS server, but does not provide failover or reconnection behav...">Client</a> to get all stored and non-discarded messages replayed by the store onto the <a class="el" href="classAMPS_1_1StoreReplayer.html" title="Abstract base class for replaying a publish message. ">StoreReplayer</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">replayer_</td><td>The <a class="el" href="classAMPS_1_1StoreReplayer.html" title="Abstract base class for replaying a publish message. ">StoreReplayer</a> to be used to replay the messages. </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classAMPS_1_1BlockPublishStore.html#a515ca2f177ec1487aab9a040ab6cccb1">AMPS::BlockPublishStore</a>, and <a class="el" href="classAMPS_1_1HybridPublishStore.html#aba6f299cb6b34a3e968ad22a896ab8c6">AMPS::HybridPublishStore</a>.</p>

</div>
</div>
<a class="anchor" id="ada24473da48fd544d789b7ec2dac7d08"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool AMPS::StoreImpl::replaySingle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAMPS_1_1StoreReplayer.html">StoreReplayer</a> &amp;&#160;</td>
          <td class="paramname"><em>replayer_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amps_uint64_t&#160;</td>
          <td class="paramname"><em>index_</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called by <a class="el" href="classAMPS_1_1Client.html" title="Client represents a connection to an AMPS server, but does not provide failover or reconnection behav...">Client</a> to get a single message replayed by the store onto the <a class="el" href="classAMPS_1_1StoreReplayer.html" title="Abstract base class for replaying a publish message. ">StoreReplayer</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">replayer_</td><td>The <a class="el" href="classAMPS_1_1StoreReplayer.html" title="Abstract base class for replaying a publish message. ">StoreReplayer</a> to be used to replay the messages. </td></tr>
    <tr><td class="paramname">index_</td><td>The index of the message to replay. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true for success, false for failure such as an invalid index. </dd></dl>

<p>Implemented in <a class="el" href="classAMPS_1_1BlockPublishStore.html#a8d197edbe25665e293aea6c5cd37e886">AMPS::BlockPublishStore</a>, and <a class="el" href="classAMPS_1_1HybridPublishStore.html#aec3215e51ae5d7df8bd00068579aa88b">AMPS::HybridPublishStore</a>.</p>

</div>
</div>
<a class="anchor" id="af38461a40772ee3147546e0e6132eea4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void AMPS::StoreImpl::setResizeHandler </td>
          <td>(</td>
          <td class="paramtype">PublishStoreResizeHandler&#160;</td>
          <td class="paramname"><em>handler_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>userData_</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set a handler to be called if the <a class="el" href="classAMPS_1_1Store.html" title="Handle class for StoreImpl classes that track publish messages. ">Store</a> needs to resize in order to keep storing messages. </p>
<p>Resize could be caused by not being connected to the server, publishing messages faster than the network or AMPS can keep up, not properly discarding messages when receiving persisted acks, or AMPS being unable to complete persistence such as when its connection to a sync replication destination is unavailable. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handler_</td><td>The handler to be called when a resize event is required. </td></tr>
    <tr><td class="paramname">userData_</td><td>The data to pass to the handler each time it is called. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classAMPS_1_1HybridPublishStore.html#a503ab3c61b0b9525d6e359535fba2348">AMPS::HybridPublishStore</a>.</p>

</div>
</div>
<a class="anchor" id="a76e41f2c8c132c63ed560135949cd220"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual amps_uint64_t AMPS::StoreImpl::store </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classAMPS_1_1Message.html">Message</a> &amp;&#160;</td>
          <td class="paramname"><em>message_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called by <a class="el" href="classAMPS_1_1Client.html" title="Client represents a connection to an AMPS server, but does not provide failover or reconnection behav...">Client</a> to store a message being published. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message_</td><td>The message to store. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The sequence number for the message. </dd></dl>

<p>Implemented in <a class="el" href="classAMPS_1_1HybridPublishStore.html#a65a6aa7146c81aa07816ddcd012cc32a">AMPS::HybridPublishStore</a>, and <a class="el" href="classAMPS_1_1BlockPublishStore.html#ad25c8608e3994048867119afa7388760">AMPS::BlockPublishStore</a>.</p>

</div>
</div>
<a class="anchor" id="a6ba03a337bf6cc5ce6545fca968ff226"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual size_t AMPS::StoreImpl::unpersistedCount </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to return how many messages are in the store that have not been discarded, indicating that they are not yet persisted by the AMPS server. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of messages not yet persisted by the AMPS server. </dd></dl>

<p>Implemented in <a class="el" href="classAMPS_1_1BlockPublishStore.html#a06f114a6f69ffe0cbca557673bcd2216">AMPS::BlockPublishStore</a>, and <a class="el" href="classAMPS_1_1HybridPublishStore.html#ab76364f40b79a5199c4038906c8e9671">AMPS::HybridPublishStore</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/amps/<a class="el" href="ampsplusplus_8hpp_source.html">ampsplusplus.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>AMPS</b></li><li class="navelem"><a class="el" href="classAMPS_1_1StoreImpl.html">StoreImpl</a></li>
    <li class="footer">Generated on Mon Oct 9 2023 18:11:31 for AMPS C/C++ Client Class Reference by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
